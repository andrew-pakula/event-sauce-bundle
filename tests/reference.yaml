andreo_eventsauce:
    time:
        timezone: UTC
        clock: EventSauce\Clock\Clock

    event_store:
        repository:
            json_encode_options:
                - !php/const JSON_PRETTY_PRINT
                - !php/const JSON_PRESERVE_ZERO_FRACTION
            doctrine:
                connection: doctrine.dbal.default_connection
                table_schema: EventSauce\MessageRepository\TableSchema\TableSchema
                table_name: event_store
    acl:
        outbound:
            filter_strategy:
                before: match_any
                after: match_any
        inbound:
            filter_strategy:
                before: match_any
                after: match_any

    message_decorator: true

    synchronous_message_dispatcher:
        chain:
            default: []

    messenger_message_dispatcher:
        chain:
            default:
                bus: eventBus
            integrating:
                bus: integratingBus
                acl: true

    event_dispatcher:
        outbox: true
        
    upcaster:
        argument: payload # one of [payload, message]

    outbox:
        back_off:
            exponential:
                initial_delay_ms: 100000
                max_tries: 10
            fibonacci:
                initial_delay_ms: 100000
                max_tries: 10
            linear:
                initial_delay_ms: 100000
                max_tries: 10
            no_waiting:
                max_tries: 10
            immediately:
                enabled: true
            custom:
                id: Foo/Bar/Baz
        relay_commit:
            delete:
                enabled: true
            mark_consumed:
                enabled: true
        repository:
            memory:
                enabled: false
            doctrine:
                table_name: outbox_message
        logger: outbox_logger

    snapshot:
        versioned: true
        store_strategy:
            every_n_event:
                number: 500
        repository:
            doctrine: true

    uuid_encoder: EventSauce\UuidEncoding\UuidEncoder
    class_name_inflector: EventSauce\EventSourcing\ClassNameInflector

    serializer:
        payload: EventSauce\EventSourcing\Serialization\ConstructingPayloadSerializer
        message: EventSauce\EventSourcing\Serialization\ConstructingMessageSerializer
        snapshot: Andreo\EventSauce\Snapshotting\SnapshotStateSerializer

    migration_generator:
        dependency_factory: doctrine.migrations.dependency_factory

    aggregates:
        foo:
            class: App\Domain\Foo
            repository_alias: fooRepository
            outbox: true
            message_dispatchers:
                - eventBus
            upcaster: true
            snapshot: true
        bar:
            class: App\Domain\Bar
            repository_alias: barRepository
            upcaster: true
            snapshot: true